{% extends "layout.html" %}

{% block title %}ğŸ“Š í†µê³„ í˜ì´ì§€{% endblock %}

{% block body %}

<h3 class="text-center mb-4">ğŸ“Š ë¶„ì‹¤ë¬¼ / ìŠµë“ë¬¼ í†µê³„</h3>

<div class="row">

    <!-- ======================================= -->
    <!-- ğŸ”¹ ì „ì²´ ìš”ì•½ ì¹´ë“œ -->
    <!-- ======================================= -->
    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h5>ğŸ“¦ ì´ ë¶„ì‹¤ë¬¼</h5>
                <h2 class="text-primary">{{ lost_count }}</h2>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h5>ğŸ“¥ ì´ ìŠµë“ë¬¼</h5>
                <h2 class="text-success">{{ found_count }}</h2>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h5>ğŸ” (ì˜µì…˜) ìë™ ë§¤ì¹­ ìˆ˜</h5>
                <h2 class="text-warning">{{ matched_count }}</h2>
            </div>
        </div>
    </div>

</div>


<hr class="my-5">

<!-- ======================================= -->
<!-- ğŸ”¹ ì¹´í…Œê³ ë¦¬ë³„ í†µê³„ ê·¸ë˜í”„ -->
<!-- ======================================= -->
<h4 class="text-center mb-3">ğŸ“Œ ì¹´í…Œê³ ë¦¬ë³„ ë¶„ì‹¤/ìŠµë“ í†µê³„</h4>
<canvas id="categoryChart" height="120"></canvas>

<hr class="my-5">

<!-- ======================================= -->
<!-- ğŸ”¹ ì¥ì†Œë³„ í†µê³„ (ë§‰ëŒ€ ê·¸ë˜í”„) -->
<!-- ======================================= -->
<h4 class="text-center mb-3">ğŸ“ ì¥ì†Œë³„ ë¶„ì‹¤/ìŠµë“ í†µê³„</h4>
<canvas id="locationChart" height="120"></canvas>


<!-- ======================================= -->
<!-- ğŸ“Œ Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
<!-- ======================================= -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // ============================================
    // ğŸ”¹ ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë˜í”„ ë°ì´í„° (views.pyì—ì„œ ì „ë‹¬ë¨)
    // ============================================
    const lost_labels = {{ lost_labels | safe }};
    const lost_values = {{ lost_values | safe }};
    const found_values = {{ found_values | safe }};

    const ctx1 = document.getElementById('categoryChart').getContext('2d');
    new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: lost_labels,
            datasets: [
                {
                    label: 'ë¶„ì‹¤ë¬¼',
                    data: lost_values,
                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                },
                {
                    label: 'ìŠµë“ë¬¼',
                    data: found_values,
                    backgroundColor: 'rgba(75, 192, 192, 0.7)',
                }
            ]
        }
    });


    // ============================================
    // ğŸ”¹ ì¥ì†Œ í†µê³„ ë°ì´í„°
    // ============================================
    const locationStats = {{ location_stats | safe }};

    const locationLabels = Object.keys(locationStats);
    const locationLost = locationLabels.map(k => locationStats[k].lost);
    const locationFound = locationLabels.map(k => locationStats[k].found);

    const ctx2 = document.getElementById('locationChart').getContext('2d');

    new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: locationLabels,
            datasets: [
                {
                    label: 'ë¶„ì‹¤ë¬¼',
                    data: locationLost,
                    backgroundColor: 'rgba(255, 99, 132, 0.7)'
                },
                {
                    label: 'ìŠµë“ë¬¼',
                    data: locationFound,
                    backgroundColor: 'rgba(255, 206, 86, 0.7)'
                }
            ]
        }
    });

</script>

{% endblock %}
